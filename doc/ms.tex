\documentclass[11pt]{article}
\pdfoutput=1

\input{header}
\input{defs}

\pdfminorversion=4

% DON'T change margins - should be 1 inch all around.
\addtolength{\oddsidemargin}{-.5in}%
\addtolength{\evensidemargin}{-1in}%
\addtolength{\textwidth}{1in}%
\addtolength{\textheight}{1.7in}%
\addtolength{\topmargin}{-1in}%

\date{}

\begin{document}

%\bibliographystyle{natbib}

\def\spacingset#1{\renewcommand{\baselinestretch}%
{#1}\small\normalsize} \spacingset{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{
    \title{Variance-Reduced Stochastic Optimization for Efficient Inference of Hidden Markov Models}

    \author{
      \textbf{Evan Sidrow} \\
      Department of Statistics \\
      University of British Columbia\\
      Vancouver, Canada \\
      \texttt{evan.sidrow@stat.ubc.ca} \\
      %
      \and
      %
      \textbf{Nancy Heckman} \\
      Department of Statistics \\
      University of British Columbia \\
      Vancouver, Canada \\
      %
      \and
      %
      \textbf{Alexandre Bouchard-C\^ot\'e} \\
      Department of Statistics \\
      University of British Columbia \\
      Vancouver, Canada \\
      \and
      %
      \textbf{Sarah M. E. Fortune} \\
      Department of Oceanography \\
      Dalhousie University \\
      Halifax, Canada \\
      %
      \and
      %
      \textbf{Andrew W. Trites} \\
      Department of Zoology \\
      Institute for the Oceans and Fisheries \\
      University of British Columbia \\
      Vancouver, Canada \\
      %
      \and
      %
      \textbf{Marie Auger-M\'eth\'e} \\
      Department of Statistics \\
      Institute for the Oceans and Fisheries \\
      University of British Columbia \\
      Vancouver, Canada \\
    }
    \maketitle
}

\bigskip
\begin{abstract}
    Hidden Markov models (HMMs) are popular models to identify a finite number of latent states from sequential data. However, fitting them to large data sets can be computationally demanding because most likelihood maximization techniques require iterating through the entire underlying data set for every parameter update. We propose a novel optimization algorithm that updates the parameters of an HMM without iterating through the entire data set. Namely, we combine a partial E step with variance-reduced stochastic optimization within the M step. We prove the algorithm converges under certain regularity conditions. We test our algorithm empirically using a simulation study as well as a case study of kinematic data collected using suction-cup attached biologgers from eight northern resident killer whales ({\em{Orcinus orca}}) off the western coast of Canada. In both, our algorithm converges in fewer epochs, with less computation time, and to regions of higher likelihood compared to standard numerical optimization techniques. Our algorithm allows practitioners to fit complicated HMMs to large time-series data sets more efficiently than existing baselines. Supplemental materials are available online.
\end{abstract}

\noindent
{\it Keywords:} Expectation-maximization algorithm, Maximum likelihood estimation, State space model, Statistical ecology, Stochastic gradient descent
\vfill 

\newpage
\spacingset{1.75} % DON'T change the spacing!

\section{Introduction}
\input sections/intro.tex

\section{Background}
\input sections/background.tex

\section{Stochastic Optimization for HMM Inference}
\input sections/model.tex

\section{Practical Considerations}
\input sections/practical.tex
\label{sec:prac}

\section{Simulation Study}
\input sections/sim_study.tex

\section{Case Study}
\input sections/case_study.tex

\section{Discussion}
\input sections/discussion.tex

\section*{Acknowledgements}
All killer whale data was collected under University of British Columbia Animal Care Permit no. A19-0053 and Fisheries and Oceans Canada Marine Mammal Scientific License for Whale Research no. XMMS 6 2019. Tags were deployed by Mike deRoos, the tagging boat skipper was Chris Hall, and photo-ID was done by Taryn Scarff. This research was enabled in part by support provided by WestGrid (www.westgrid.ca) and Compute Canada (www.computecanada.ca). We also thank the reviewers for their constructive comments.

\section*{Funding}
We acknowledge the support of the Natural Sciences and Engineering Research Council of Canada (NSERC) as well as the support of Fisheries and Oceans Canada (DFO). This project was supported by a financial contribution from the DFO and NSERC (Whale Science for Tomorrow). This work was also supported by the NSERC Discovery program under grant RGPIN-2020-04629; the Canadian Research Chairs program for Statistical Ecology; the BC Knowledge Development fund; the Canada Foundation for Innovation (John R. Evans Leaders Fund) under grant 37715; and the University of British Columbia via the Four-Year Doctoral Fellowship program.

\section*{Disclosure}
The authors report there are no competing interests to declare.

\section*{Supplemental Material}
\begin{description}
    \item[Appendix:] Contains alternate version of Algorithm \ref{alg:EM-VRSO} and proofs for all theorems. (\texttt{appendix.pdf}, pdf file) 
    \item[Supplement A:] Additional results from the simulation study, including plots of likelihood vs computation time, plots for all five simulated data sets, and results for experiments with $T=10^3$. (\texttt{supp\_A.pdf}, pdf file)
    \item[Supplement B:] Additional results from the case study, including parameter estimates of the final model and dive profiles for all eight killer whales. (\texttt{supp\_B.pdf}, pdf file)
    \item[Code:] Code and data to run experiments and plot results from the manuscript can be found at \texttt{https://github.com/evsi8432/sublinear-HMM-inference}.
\end{description} 

\bibliography{References}

\end{document}
